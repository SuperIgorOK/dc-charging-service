# ‚ö° DC Charging Service

–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±—ã—Å—Ç—Ä—ã–º–∏ DC –∑–∞—Ä—è–¥–Ω—ã–º–∏ —Å—Ç–∞–Ω—Ü–∏—è–º–∏ (–¥–æ 240 –∫–í—Ç, –¥–æ 3 –∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä–æ–≤, CCS/CHAdeMO/GB/T).  
–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø—Ä–æ—Ç–æ–∫–æ–ª OCPP 2.0.1, –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —á–µ—Ä–µ–∑ MQTT, REST API –∏ WebSocket.  
–°–∏—Å—Ç–µ–º–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø–∞–º —á–∏—Å—Ç–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –∏ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞.

## üõ†Ô∏è –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

- FastAPI  
- PostgreSQL + TimescaleDB  
- Redis OM  
- RabbitMQ  
- Celery + Beat  
- MQTT (paho.mqtt)  
- Docker + docker-compose  
- Pytest + coverage  
- GitHub Actions CI

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

apps/  
‚îú‚îÄ‚îÄ api/ ‚Äî FastAPI —Ä–æ—É—Ç—ã  
‚îú‚îÄ‚îÄ celery/ ‚Äî –∑–∞–¥–∞—á–∏ Celery (–ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Å—Ç–∞–Ω—Ü–∏–π –∏ –¥—Ä.)  
‚îú‚îÄ‚îÄ repositories/ ‚Äî —Ä–∞–±–æ—Ç–∞ —Å –ë–î (SQLAlchemy)  
‚îú‚îÄ‚îÄ schemas/ ‚Äî Pydantic-—Å—Ö–µ–º—ã, –≤ —Ç.—á. Redis-–º–æ–¥–µ–ª–∏  
‚îú‚îÄ‚îÄ services/ ‚Äî –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ (OCPP, MQTT, —Å—Ç–∞–Ω—Ü–∏–∏, —Å–µ—Å—Å–∏–∏)  
‚îú‚îÄ‚îÄ settings/ ‚Äî –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞  

## üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞


### ‚öôÔ∏è –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –°–æ–∑–¥–∞–π —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –µ–≥–æ –ø–æ–¥–æ–±–Ω–æ .env.example
- –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –≤ –∫–æ—Ä–µ–Ω—å –ø—Ä–æ–µ–∫—Ç–∞:  
```git clone https://github.com/SuperIgorOK/dc-charging-service.git```

- –î–∞–ª–µ–µ –∑–∞–ø—É—Å—Ç–∏—Ç–µ:

```docker-compose up --build  ```

–°—Å—ã–ª–∫–∏:  
- Swagger-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: http://localhost:8000/docs  
- Adminer: http://localhost:8080

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π  
pip install -r requirements.txt  

# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º  
coverage run -m pytest  
coverage report  

## üîÅ –§–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏ (Celery + Beat)

–ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ (–∫–∞–∂–¥—ã–µ 1 –º–∏–Ω):  
- –ü–æ–ª—É—á–∞–µ—Ç –≤—Å–µ —Å—Ç–∞–Ω—Ü–∏–∏ –∏–∑ –ë–î  
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç Redis (–∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä—ã —Å—Ç–∞–Ω—Ü–∏–∏)  
- –ï—Å–ª–∏ –≤—Å–µ –∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä—ã –Ω–µ –æ–±–Ω–æ–≤–ª—è–ª–∏—Å—å > 2 –º–∏–Ω—É—Ç ‚Üí –ø–µ—Ä–µ–≤–æ–¥–∏—Ç —Å—Ç–∞–Ω—Ü–∏—é –≤ —Å—Ç–∞—Ç—É—Å offline  

## üì° MQTT-—Ç–æ–ø–∏–∫–∏

- stations/<station_id>/telemetry ‚Äì –ø–æ–∫–∞–∑–∞–Ω–∏—è —Ç–æ–∫–∞, –Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è, —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã 
- stations/<station_id>/events ‚Äì session_started / session_finished.  

## üßµ REST API

- GET /stations/{station_id} ‚Äî –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å—Ç–∞–Ω—Ü–∏–∏ –∏ –∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä–æ–≤  
- GET /stations/{id}/sessions ‚Äî –ò—Å—Ç–æ—Ä–∏—è —Å–µ—Å—Å–∏–π (—Ñ–∏–ª—å—Ç—Ä –ø–æ –¥–∏–∞–ø–∞–∑–æ–Ω—É –≤—Ä–µ–º–µ–Ω–∏)  
- GET /health ‚Äî –°–µ—Ä–≤–∏—Å—á–µ–∫ –¥–ª—è –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä–∞

## üîß GitHub Actions CI

- –ü—Ä–æ–≥–æ–Ω pytest –ø—Ä–∏ –∫–∞–∂–¥–æ–º push  
- –û—Ç—á—ë—Ç –ø–æ –ø–æ–∫—Ä—ã—Ç–∏—é (coverage)   
